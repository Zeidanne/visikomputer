{% extends 'base.html' %}

{% block title %}GLCM Texture Feature Extraction{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/glcm.css') }}">
{% endblock %}

{% block content %}
<!-- Page Header -->
<header class="page-header">
    <h1>Ekstraksi Fitur Tekstur</h1>
    <p>Gray Level Co-occurrence Matrix (GLCM) untuk analisis tekstur gambar</p>
</header>

<!-- GLCM Info Section -->
<div class="collapsible" id="infoCollapsible">
    <div class="collapsible-header">
        Tentang GLCM (Gray Level Co-occurrence Matrix)
    </div>
    <div class="collapsible-content">
        <p>
            GLCM adalah metode statistik untuk mengekstraksi fitur tekstur dari gambar. 
            Metode ini menganalisis hubungan spasial antara piksel dengan menghitung 
            frekuensi pasangan piksel dengan nilai intensitas tertentu pada jarak dan sudut tertentu.
        </p>

        <h4 class="mt-3">Fitur yang Diekstraksi:</h4>
        <ul class="glcm-features-list">
            <li><strong>Contrast:</strong> Mengukur perbedaan intensitas antara piksel dan tetangganya</li>
            <li><strong>Dissimilarity:</strong> Mengukur ketidaksamaan antar piksel</li>
            <li><strong>Homogeneity:</strong> Mengukur keseragaman tekstur</li>
            <li><strong>Energy:</strong> Mengukur keseragaman distribusi piksel (Angular Second Moment)</li>
            <li><strong>Correlation:</strong> Mengukur korelasi linear antara piksel bertetangga</li>
        </ul>

        <h4 class="mt-3">Parameter GLCM:</h4>
        <ul class="glcm-features-list">
            <li><strong>Distances:</strong> Jarak piksel (contoh: 1, 2, 3)</li>
            <li><strong>Angles:</strong> Sudut arah analisis (0째, 45째, 90째, 135째)</li>
            <li><strong>Gray Levels:</strong> Jumlah level kuantisasi (8, 16, 32, 64, 128, 256)</li>
        </ul>
    </div>
</div>

<!-- Upload and Extract Section -->
<div class="glass-card no-hover">
    <div class="card-header">
        <h3>Upload Gambar & Ekstraksi Fitur</h3>
    </div>

    <form id="glcmForm" enctype="multipart/form-data">
        <!-- Image Upload Area -->
        <div class="form-group">
            <label class="form-label">Pilih Gambar</label>
            <div class="upload-area" id="uploadArea">
                <div class="upload-text">Klik atau drag & drop gambar di sini</div>
                <div class="upload-hint">Format: PNG, JPG, JPEG, BMP, TIFF (Max: 16MB)</div>
                <input type="file" id="imageInput" name="image" accept="image/*" required>
            </div>
        </div>

        <!-- Image Preview -->
        <div id="preview-container" class="hidden">
            <h4>Preview Gambar</h4>
            <img id="preview" src="" alt="Preview">
        </div>

        <!-- Parameters -->
        <div class="grid grid-3 mt-3">
            <div class="form-group">
                <label class="form-label" for="distancesInput">Distances (Jarak Piksel)</label>
                <input type="text" class="form-control" id="distancesInput" name="distances" 
                       value="1" placeholder="1,2,3">
                <span class="form-hint">Pisahkan dengan koma (contoh: 1,2,3)</span>
            </div>

            <div class="form-group">
                <label class="form-label" for="anglesInput">Angles (Derajat)</label>
                <input type="text" class="form-control" id="anglesInput" name="angles" 
                       value="0,45,90,135" placeholder="0,45,90,135">
                <span class="form-hint">Sudut analisis dalam derajat</span>
            </div>

            <div class="form-group">
                <label class="form-label" for="levelsInput">Gray Levels</label>
                <select class="form-control" id="levelsInput" name="levels" required>
                    <option value="8">8 levels</option>
                    <option value="16">16 levels</option>
                    <option value="32">32 levels</option>
                    <option value="64">64 levels</option>
                    <option value="128">128 levels</option>
                    <option value="256" selected>256 levels</option>
                </select>
                <span class="form-hint">Jumlah level kuantisasi</span>
            </div>
        </div>

        <button type="submit" class="btn btn-primary btn-block btn-lg mt-2">
            Ekstraksi Fitur GLCM
        </button>
    </form>

    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p>Memproses gambar...</p>
    </div>

    <!-- Results Section -->
    <div id="resultsSection" class="glcm-results hidden">
        <h3 class="mb-3">Hasil Ekstraksi Fitur</h3>

        <!-- Parameters Used -->
        <div class="glass-card mb-3">
            <h4 class="mb-2">Parameter yang Digunakan</h4>
            <div id="parametersDisplay" class="param-grid"></div>
        </div>

        <!-- Feature Results -->
        <div class="glass-card">
            <h4 class="mb-2">Fitur GLCM (Nilai Rata-rata)</h4>
            <div id="featuresResults"></div>
        </div>
    </div>

    <!-- Error Section -->
    <div id="errorSection" class="hidden mt-3">
        <div class="alert alert-error">
            <span id="errorMessage"></span>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/glcm.js') }}"></script>
{% endblock %}
